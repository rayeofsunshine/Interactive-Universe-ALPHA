<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Universe Engine V0.2 â€” With Editor Panel</title>
<style>
    body { margin:0; overflow:hidden; background:black; font-family:Arial; }

    /* UI PANEL */
    #panel {
        position: absolute;
        top: 15px;
        left: 15px;
        background: rgba(255, 255, 255, 0.9);
        padding: 12px 15px;
        border-radius: 8px;
        width: 210px;
        font-size: 14px;
        box-shadow: 0 0 8px rgba(255,255,255,0.4);
    }

    #panel h2 {
        margin: 0 0 10px;
        font-size: 16px;
        text-align: center;
    }

    .section {
        margin-bottom: 12px;
    }

    label {
        display: block;
        margin-bottom: 3px;
        font-weight: bold;
    }

    input[type="range"], select {
        width: 100%;
    }

    button {
        width: 100%;
        padding: 8px;
        border: none;
        background: black;
        color: white;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
    }

    button:hover {
        background: #333;
    }
</style>
</head>
<body>

<!-- UI PANEL -->
<div id="panel">
    <h2>Universe Settings</h2>

    <div class="section">
        <label>Gravity</label>
        <input id="gravitySlider" type="range" min="0" max="0.1" step="0.005" value="0.02">
    </div>

    <div class="section">
        <label>Spawn Rate</label>
        <input id="spawnSlider" type="range" min="1" max="20" step="1" value="3">
    </div>

    <div class="section">
        <label>Max Particles</label>
        <input id="maxSlider" type="range" min="500" max="8000" step="100" value="4000">
    </div>

    <div class="section">
        <label>Color Mode</label>
        <select id="colorMode">
            <option value="shift">Color Shift</option>
            <option value="energy">Energy Glow</option>
            <option value="seed">Life Seed Colors</option>
        </select>
    </div>

    <button id="resetBtn">Reset Universe</button>
</div>

<canvas id="universe"></canvas>

<script>
// =====================================================
//  UNIVERSE ENGINE V0.2
//  (Now with editable settings panel)
// =====================================================

const canvas = document.getElementById('universe');
const ctx = canvas.getContext('2d');

let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
});

// Engine Core
const ENGINE = {
    particles: [],
    maxParticles: 4000,
    gravityStrength: 0.02,
    spawnRate: 3,
    colorMode: "shift",
    mouse: { x: 0, y: 0, down: false }
};

// UI Elements
const gSlider = document.getElementById("gravitySlider");
const sSlider = document.getElementById("spawnSlider");
const mSlider = document.getElementById("maxSlider");
const colorSelect = document.getElementById("colorMode");
const resetBtn = document.getElementById("resetBtn");

// Hook UI to Engine
gSlider.oninput = () => ENGINE.gravityStrength = parseFloat(gSlider.value);
sSlider.oninput = () => ENGINE.spawnRate = parseInt(sSlider.value);
mSlider.oninput = () => ENGINE.maxParticles = parseInt(mSlider.value);
colorSelect.onchange = () => ENGINE.colorMode = colorSelect.value;

// Reset Universe Button
resetBtn.onclick = () => {
    ENGINE.particles = [];
    for (let i = 0; i < 600; i++) {
        ENGINE.particles.push(new Particle(Math.random()*W, Math.random()*H));
    }
};

// Mouse Events
canvas.addEventListener('mousedown', () => ENGINE.mouse.down = true);
canvas.addEventListener('mouseup', () => ENGINE.mouse.down = false);
canvas.addEventListener('mousemove', e => {
    ENGINE.mouse.x = e.clientX;
    ENGINE.mouse.y = e.clientY;
});

// Particle Class
class Particle {
    constructor(x,y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random()-0.5)*1.2;
        this.vy = (Math.random()-0.5)*1.2;
        this.energy = 80 + Math.random()*60;
        this.type = Math.random()<0.05 ? 1 : 0;
        this.colorShift = Math.random()*360;
    }

    update() {
        this.energy -= 0.03;

        if (ENGINE.mouse.down) {
            let dx = ENGINE.mouse.x - this.x;
            let dy = ENGINE.mouse.y - this.y;
            let dist = Math.sqrt(dx*dx + dy*dy);

            if (dist < 200) {
                this.vx += dx / dist * ENGINE.gravityStrength;
                this.vy += dy / dist * ENGINE.gravityStrength;
            }
        }

        this.x += this.vx;
        this.y += this.vy;

        if (this.x < 0) this.x = W;
        if (this.x > W) this.x = 0;
        if (this.y < 0) this.y = H;
        if (this.y > H) this.y = 0;

        // Reproduction
        if (this.energy > 90 && ENGINE.particles.length < ENGINE.maxParticles && Math.random() < 0.005) {
            ENGINE.particles.push(new Particle(this.x, this.y));
            this.energy -= 25;
        }

        return this.energy > 0;
    }

    draw() {
        this.colorShift += 0.5;

        let color;

        if (ENGINE.colorMode === "shift")
            color = `hsl(${this.colorShift}, 80%, 60%)`;

        else if (ENGINE.colorMode === "energy")
            color = `rgba(0, ${this.energy*2}, 255, 0.9)`;

        else if (ENGINE.colorMode === "seed")
            color = this.type === 1 ? "rgba(255,180,80,1)" : "rgba(80,180,255,0.7)";

        ctx.fillStyle = color;
        ctx.fillRect(this.x, this.y, 2, 2);
    }
}

// Initial Spawn
for (let i = 0; i < 600; i++) {
    ENGINE.particles.push(new Particle(Math.random()*W, Math.random()*H));
}

// Loop
function loop() {
    ctx.fillStyle = "rgba(0,0,0,0.1)";
    ctx.fillRect(0,0,W,H);

    // Spawn on mouse hold
    if (ENGINE.mouse.down) {
        for (let i = 0; i < ENGINE.spawnRate; i++) {
            ENGINE.particles.push(new Particle(ENGINE.mouse.x, ENGINE.mouse.y));
        }
    }

    // Update + Draw
    for (let i = ENGINE.particles.length-1; i>=0; i--) {
        let p = ENGINE.particles[i];
        if (!p.update()) {
            ENGINE.particles.splice(i,1);
            continue;
        }
        p.draw();
    }

    requestAnimationFrame(loop);
}

loop();

</script>
</body>
</html>